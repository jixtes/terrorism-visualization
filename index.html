<!-- Code from d3-graph-gallery.com -->
<!DOCTYPE html>
<meta charset="utf-8">

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>
<!-- Load d3.js -->
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>
<!-- <script src="barcharts.js"></script> -->
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap-theme.min.css" integrity="sha384-6pzBo3FDv/PJ8r2KRkGHifhEocL+1X2rVCTTkUfGk7/0pbek5mMa1upzvWbrUbOZ" crossorigin="anonymous">
<style >

#my_dataviz2 svg,#my_dataviz3 svg{
  overflow: visible !important
}
</style>
<!-- Latest compiled and minified JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>
<!-- Create a div where the graph will take place -->

<div class='tableauPlaceholder' id='viz1717413871141' style='position: relative'>
  <noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Te&#47;TerrorismVisualization_globalUS&#47;Dashboard2&#47;1_rss.png' style='border: none' /></a>
  </noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> 
    <param name='site_root' value='' /><param name='name' value='TerrorismVisualization_globalUS&#47;Dashboard2' /><param name='tabs' value='yes' /><param name='toolbar' value='yes' />
    <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Te&#47;TerrorismVisualization_globalUS&#47;Dashboard2&#47;1.png' /> 
    <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' />
    <param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' /><param name='filter' value='publish=yes' /></object></div>                
<script type='text/javascript'> 
  var divElement = document.getElementById('viz1717413871141');                    
  var vizElement = divElement.getElementsByTagName('object')[0];                    
  if ( divElement.offsetWidth > 800 ) { vizElement.style.minWidth='2000px';vizElement.style.maxWidth='100%';vizElement.style.minHeight='1050px';vizElement.style.maxHeight=(divElement.offsetWidth*0.75)+'px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.minWidth='1200px';vizElement.style.maxWidth='100%';vizElement.style.minHeight='1050px';vizElement.style.maxHeight=(divElement.offsetWidth*0.75)+'px';} else { vizElement.style.width='100%';vizElement.style.minHeight='2500px';vizElement.style.maxHeight=(divElement.offsetWidth*1.77)+'px';}                     var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>


<div class="container">

<div style="position:absolute;right:10%; width:250px">
<div class="row">
</div>
<div class="row">
  <br><br>

<svg width="320" height="50" viewBox="0,0,320,50" style="overflow: visible; display: block;"><image x="0" y="18" width="320" height="10" preserveAspectRatio="none" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAABCAYAAAAxWXB3AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABAKADAAQAAAABAAAAAQAAAACR1uBcAAAA0UlEQVQ4EaVQSQ4DMQib/v+rvfcWigGzJJF6qDQjB2OMk5d83vI8+PQ3XIGsd5x9+Tk39b5HuZyj/85ttew+1bcM5hdc9+5zg8fem175XXfUeCLmDj3qv3/Nsy4+q3JK7zd+zAVv70I9ERn1nG8W/NAiQtP72e9cfGl8NvrpP/Wgc2/spxf9gcwBFN7j4OsO0Li2c/BRHndou+jJPQNTV370vaLlg71nTi+rJ48Y5oGePQNmnLOesq7ROT2jRzQ9Z4D6e1+RNeZN0znXmj51J/cFFl8InjJE1EUAAAAASUVORK5CYII="></image><g transform="translate(0,28)" fill="none" font-size="10" font-family="sans-serif" text-anchor="middle"><g class="tick" opacity="1" transform="translate(80,0)"><line stroke="currentColor" y2="6" y1="-10"></line><text fill="currentColor" y="9" dy="0.71em">50</text></g><g class="tick" opacity="1" transform="translate(160,0)"><line stroke="currentColor" y2="6" y1="-10"></line><text fill="currentColor" y="9" dy="0.71em">500</text></g><g class="tick" opacity="1" transform="translate(240,0)"><line stroke="currentColor" y2="6" y1="-10"></line><text fill="currentColor" y="9" dy="0.71em">2000</text></g><g class="tick" opacity="1" transform="translate(320,0)"><line stroke="currentColor" y2="6" y1="-10"></line><text fill="currentColor" y="9" dy="0.71em">10,000</text></g><text x="0" y="-16" fill="currentColor" text-anchor="start" font-weight="bold" class="title">Number of attacks</text></g></svg>
  <br><br>
</div>
<div class="panel panel-default">
<div class="panel-heading" style="background:#eee">
  <h4 id="country-name">Ethiopia</h4>
</div>
<div class="panel-body">
  <b># of attacks</b>
<br>
   <span id="country-attack">100,100</span>
   <b>
     <br>
     <br>
  # of fatalities
</b>
<br>
  <span id="country-fatalities">100,100</span>
  <br>
     <br>
  <b>Most attacks</b> <br>
  <span id="most-attacks">Bombings</span>
  <br>
  <br>

  <b>Top perpetrators</b> <br>
  <ol>
    <li id="perp1">hale end</li>
    <li id="perp2">malewood</li>
    <li id="perp3">stke</li>
  </ol>
</div>
</div>


</div>
<div class="row">
  <div class="col col-lg-5">&nbsp;</div>
<h1 class="col col-lg-5">Global view</h1>
</div>
<div class="row">

  <div class="col col-lg-12">
    <svg id="my_dataviz1" width=1000 height=450></svg>
  </div>
</div>
<div class="row" style="margin-left:8%; position: relative; top: -65px;">
  <div class="col col-lg-6">
    <h3>Attack types</h3>
    <div id="my_dataviz2"></div>
  </div>
  <div class="col col-lg-6">
    <h3>Perpetrators</h3>
    <div id="my_dataviz3"></div>
  </div>

</div>
</div>


<script src="d3_instance.js"></script>

<script>

// The svg
var svgx = d3.select("#my_dataviz1"),
  width = +svgx.attr("width"),
  height = +svgx.attr("height");

// Map and projection
var path = d3.geoPath();
var projection = d3.geoMercator()
  .scale(140)
  .center([0,15])
  .translate([width / 2, height / 2]);

// Data and color scale
var data = d3.map();
var colorScale = d3.scaleThreshold()
  .domain([10,50,100,500,2000,3000,7000])
  .range(d3.schemeOrRd[7]);

// Load external data and boot
d3.queue()
  .defer(d3.json, "https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson")
  .defer(d3.csv, "num_attacks_country.csv", function(d) { data.set(d.code, +d.pop); })
  .await(ready);

function ready(error, topo) {

  let mouseOver = function(d) {
    update_chart(d.id)
    d3.selectAll(".Country")
      .transition()
      .duration(200)
      .style("opacity", .5)
    d3.select(this)
      .transition()
      .duration(200)
      .style("opacity", 1)
      .style("stroke", "black")
  }

  let mouseLeave = function(d) {
    update_chart('all')
    d3.selectAll(".Country")
      .transition()
      .duration(200)
      .style("opacity", .8)
      .style("stroke", "None")
    d3.select(this)
      .transition()
      // .style("opacity", 0)
      .duration(200)
      .style("stroke", "transparent")
  }

  // Draw the map
  svgx.append("g")
    .selectAll("path")
    .data(topo.features)
    .enter()
    .append("path")
      // draw each country
      .attr("d", d3.geoPath()
        .projection(projection)
      )
      // set the color of each country
      .attr("fill", function (d) {
        d.total = data.get(d.id) || 0;
        return colorScale(d.total);
      })
      .style("stroke", "transparent")
      .attr("class", function(d){ return "Country" } )
      .style("opacity", .8)
      .on("mouseover", mouseOver )
      .on("mouseleave", mouseLeave )
    }

    plot_d3()
</script>
